@using TicketMonster.ApplicationCore.Services.User;
@using TicketMonster.Web.Services;
@using TicketMonster.Web.ViewModels;
@using TicketMonster.Web.ViewModels.Purchase;
@inject UserManager _userManger
@inject UserService _user

@model PurchasePageViewModel
@{
    Layout = null;
    string seatJson = Newtonsoft.Json.JsonConvert.SerializeObject(ViewData["seatNumJson"]);
    string seatSectionJson = Newtonsoft.Json.JsonConvert.SerializeObject(ViewData["seatSection"]);
    string theaterSeatJson = Newtonsoft.Json.JsonConvert.SerializeObject(ViewData["theaterSeat"]);
    var currentUser = await _user.GetCustomerInfo(_userManger.GetCurrentUserId());
    ViewBag.currentUserName = currentUser?.LastName;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TicketMonster</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
          crossorigin="anonymous" />
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
          integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
          crossorigin="anonymous"
          referrerpolicy="no-referrer" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
            crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.slim.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>

    <style>
        .dropdown-menu[data-bs-popper] {
            right: 0;
            left: auto;
        }

        .list-unstyledd {
            padding-left: 0;
            list-style: none;
        }

        .OutField:hover {
            fill: black;
        }

        .Middle:hover {
            fill: black;
        }

        .Inner:hover {
            fill: black;
        }

        [class*="Theater"]:hover {
            fill: black;
        }

        .filterbtn:hover {
            border: 1px solid #4070f4;
        }

        .form-select:hover {
            transform: scale(1.01);
        }

        .zoomin:hover {
            background-color: #0256b2;
            color: white;
        }

        .reset:hover {
            background-color: #0256b2;
            color: white;
        }

        .zoomout:hover {
            background-color: #0256b2;
            color: white;
        }

        .container-fluid {
            padding-left: 0;
            background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNDM3IDU3Ij48Zz48ZyBvcGFjaXR5PSIuMTAyIj48bGluZWFyR3JhZGllbnQgaWQ9ImEiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iNDEzLjM0NSIgeTE9IjUwNC4zMzYiIHgyPSI0MTMuMDM0IiB5Mj0iNTA0Ljg3IiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDE0NDAgMCAwIC0yMTggLTU5NDMwNyAxMTAwMjMpIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiMwMjQ2OTEiLz48c3RvcCBvZmZzZXQ9Ii41MyIgc3RvcC1jb2xvcj0iI2JhZGJmZSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI2M1NmJmZiIvPjwvbGluZWFyR3JhZGllbnQ+PHBhdGggZmlsbD0idXJsKCNhKSIgZD0iTTAtLjJoMTE3LjJMMTQ0MCA1N0gzOTEuOXoiLz48Zz48bGluZWFyR3JhZGllbnQgaWQ9ImIiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iNDEzLjM4NyIgeTE9IjUwNC4xOTIiIHgyPSI0MTMuMDE5IiB5Mj0iNTA0Ljk3NiIgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxNDQwIDAgMCAtMjE4IC01OTQzMDcgMTEwMDIzKSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLW9wYWNpdHk9IjAiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3Atb3BhY2l0eT0iLjQiLz48c3RvcCBvZmZzZXQ9IjEiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3Atb3BhY2l0eT0iLjQiLz48L2xpbmVhckdyYWRpZW50PjxwYXRoIGZpbGw9InVybCgjYikiIGQ9Ik0wLS4yaDExNy4yTDE0NDAgNTdIMzkxLjl6Ii8+PC9nPjwvZz48bGluZWFyR3JhZGllbnQgaWQ9ImMiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4MT0iNDE0LjI2NiIgeTE9IjUwNC4yNjkiIHgyPSI0MTQuMzgiIHkyPSI1MDQuNTg2IiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KC00NzQuNjU5MiAwIDAgLTIxOCAxOTc4ODQuMjY2IDExMDAyMikiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1vcGFjaXR5PSIwIi8+PHN0b3Agb2Zmc2V0PSIxIi8+PHN0b3Agb2Zmc2V0PSIxIi8+PC9saW5lYXJHcmFkaWVudD48cGF0aCBvcGFjaXR5PSIuMDQ5IiBmaWxsPSJ1cmwoI2MpIiBkPSJNMTQzNy0uNUw5NjIuMyA1Ni43SDE0Mzd6Ii8+PC9nPjwvc3ZnPg==), linear-gradient(to right, #002da1, #026cdf, #002da1);
        }

        .zoomer .pic svg {
            aspect-ratio: 3/2;
        }

        .btn {
            --bs-btn-hover-bg: none;
            --bs-btn-hover-border-color: none;
            --bs-btn-hover-color: none;
            --bs-btn-border-width: none;
            --bs-btn-bg: none;
        }

        .userlogo::after {
            content: "";
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 1px solid white;
            position: relative;
        }

        /*   .fa-user {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            position: absolute;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            color: white;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }*/

        .sign-in {
            color: white;
            cursor: pointer;
        }

        .input-group::after {
            content: "";
            height: 1px;
            width: 100%;
            background-color: black;
        }

        .help,
        .fri-text,
        .download-text {
            font-size: 12px;
        }

        .get-help::before {
            content: "";
            display: inline-block;
            width: 15px;
            height: 15px;
            border: 1px solid gray;
            border-radius: 50%;
            background-image: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%224.982%22%20height%3D%228%22%20viewBox%3D%220.5%20-0.012%204.982%208%22%3E%3Ctitle%3EFill%2047%3C/title%3E%3Cpath%20fill%3D%22%23262626%22%20d%3D%22M.674%201.593C.79%201.256.96.973%201.19.735c.227-.235.503-.42.83-.55.323-.13.693-.197%201.11-.197.326%200%20.63.048.91.146.282.097.532.238.748.423.215.186.386.41.51.672.122.262.185.563.185.903%200%20.433-.094.8-.284%201.1-.19.302-.43.592-.724.87-.24.238-.43.426-.574.56-.145.135-.25.27-.32.4s-.115.29-.138.48c-.023.19-.04.307-.046.662h-.73c-.007-.354.012-.497.058-.737s.12-.456.226-.65c.104-.192.243-.376.417-.556.172-.177.382-.377.63-.602.217-.2.396-.425.538-.672.142-.247.213-.52.213-.822%200-.23-.043-.444-.13-.637-.09-.193-.21-.358-.36-.492-.15-.136-.327-.242-.527-.32C3.53.643%203.32.604%203.095.604c-.31%200-.584.054-.823.162-.24.11-.436.256-.59.445s-.27.41-.348.667c-.078.254-.112.463-.104.765H.5c0-.41.058-.712.174-1.05zM2.55%207.097h.89v.89h-.89v-.89z%22/%3E%3C/svg%3E);
            background-repeat: no-repeat;
            background-size: contain;
            background-position: center;
            margin-right: 10px;
        }

        .inside::before {
            content: "";
            display: inline-block;
            width: 15px;
            height: 15px;
            background-image: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2217%22%20height%3D%2216%22%20viewBox%3D%220%200%2017%2016%22%3E%3Ctitle%3EFill%2059%3C%2Ftitle%3E%3Cpath%20fill%3D%22%23262626%22%20d%3D%22M3.5%2015.96h-.904l.532-.73c.403-.553.667-1.257.802-2.147C1.417%2011.96.04%209.813.04%207%20.04%202.707%203.282.04%208.5.04S16.96%202.707%2016.96%207c0%204.357-3.163%206.96-8.46%206.96-.118%200-.234-.003-.35-.007-.795.957-2.22%202.007-4.65%202.007zm5-15C3.78.96.96%203.218.96%207c0%203.244%201.98%204.71%203.64%205.367l.328.13-.04.35c-.09.828-.275%201.537-.558%202.144%201.698-.21%202.688-1.058%203.238-1.783l.145-.19.31.012c.157.003.315.01.477.01%206.805%200%207.54-4.224%207.54-6.04%200-3.782-2.82-6.04-7.54-6.04z%22%2F%3E%3C%2Fsvg%3E);
            background-repeat: no-repeat;
            background-size: contain;
            background-position: center;
            margin-right: 10px;
        }

        .spantext {
            font-size: 2px;
        }

        .paypalpic {
            width: 60px;
        }

        .appstore {
            width: 80px;
        }

        .googleplay {
            width: 100px;
        }

        .widget {
            background-color: #0256b2;
        }

        .map {
            padding-right: 0;
        }

        .widget-img {
            width: 143px;
        }

        .widget-title {
            font-size: 15px;
        }

        .infobtn {
            border: 1px solid white;
            padding: 0.4px 14px;
            font-size: 7px;
            border-radius: 80px;
        }

        .widget-info {
            line-height: 2px;
        }

        .widgetdate,
        .widgetarea {
            font-size: 8px;
        }

        .image {
            vertical-align: top;
            object-fit: contain;
            max-width: 100%;
        }

        .filterimg {
            width: 15px;
            vertical-align: middle;
            margin-right: 4px;
            margin-bottom: 2px;
        }

        .dropdown-toggle {
            outline: 1px solid #026cdf;
            border-radius: 5px;
            --bs-btn-color: none;
            color: #026cdf;
            font-size: 13px;
        }

        .filter-bar__mobile-icon-filter {
            display: inline-block;
            width: 18px;
            height: 18px;
            fill: #026cdf;
        }

        .filterbtn {
            outline: 1px solid #026cdf;
            border-radius: 5px;
            color: #026cdf;
            font-size: 13px;
        }

        .memo-text {
            padding: 0 16px 16px;
            font-size: 9px;
            color: #727272;
            border-bottom: 1px solid #ebebeb;
        }

        .lower-price {
            border-bottom: 1px solid #ebebeb;
        }

        .lowerPrice {
            color: #026cdf;
        }

        .seatNum {
            color: #262626;
            font-size: 11px;
            font-weight: bolder;
        }

        .seat-type {
            color: #727272;
            font-size: 8px;
        }

        .seatPrice {
            color: #026cdf;
            font-size: 10px;
            font-weight: bolder;
        }

        .bcg-hover:hover {
            background-color: #e6f0fc;
        }

        .ticketsite {
            background-color: #fff;
            overflow: hidden;
        }

        .ava svg {
            width: 16px;
            height: 16px;
            fill: rgb(2, 108, 223);
        }

        .loc svg {
            width: 16px;
            height: 16px;
            fill: rgb(2, 108, 223);
        }

            .loc svg path {
                fill: rgb(255, 255, 255);
            }

        .acc svg {
            width: 16px;
            height: 16px;
            fill: rgb(2, 108, 223);
        }

            .acc svg path {
                fill: rgb(255, 255, 255);
            }

        .una svg {
            width: 16px;
            height: 16px;
            fill: rgb(235, 235, 235);
        }

        .map-container .accordion {
            position: absolute;
            right: 15px;
            bottom: 15px;
        }

        .map-container .accordion-body {
            font-size: 12px;
            white-space: nowrap;
            line-height: 25px;
        }

        .map-container {
            background-color: rgb(232, 236, 242);
            height: calc(100vh - 154.55px);
            position: relative;
        }

        .zoomer-controls {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: white;
            border-radius: 3px;
        }

        .under-memo {
            font-size: 10px;
            position: absolute;
            bottom: 8px;
            left: 0px;
            z-index: 1;
            width: 100%;
            text-align: center;
            padding: 0px 8px;
            color: rgba(38, 38, 38, 0.65);
        }

        .terms {
            padding: 0px;
            font-size: 10px;
            color: rgba(38, 38, 38, 0.65);
        }

        .cookie {
            padding: 0px;
            font-size: 10px;
            color: rgba(38, 38, 38, 0.65);
        }

        .cf {
            width: 100%;
            background-image: none;
        }

        .price-input {
            display: flex;
            width: 100%;
        }

        .field {
            display: flex;
            width: 50px;
            height: 30px;
            align-items: center;
        }

        .min-input,
        .max-input {
            width: 100%;
            height: 100%;
            outline: none;
            border: 1px solid #999;
            border-radius: 5px;
            text-align: center;
            font-size: 18px;
        }

            .min-input::-webkit-outer-spin-button,
            .min-input::-webkit-inner-spin-button,
            .max-input::-webkit-outer-spin-button,
            .max-input::-webkit-inner-spin-button {
                display: none;
            }

        .progress {
            position: absolute;
            height: 100%;
            width: 100%;
            /* left: 5%; */
            /* right: 65%; */
            background-color: #4070f4;
            border-radius: 5px;
        }

        .range-input {
            position: relative;
        }

            .range-input input {
                position: absolute;
                width: 100%;
                height: 5px;
                top: -5px;
                pointer-events: none;
                background: none;
                appearance: none;
            }

                .range-input input::-webkit-slider-thumb {
                    height: 15px;
                    width: 15px;
                    background-color: #4070f4;
                    border-radius: 50%;
                    pointer-events: auto;
                }

        .modal {
            color: black;
        }

        .modal-header {
            color: white;
            padding: 5px;
        }

            .modal-header .btn-close {
                margin: 0;
            }

        .breadcrumbs__brand-logo {
            width: 83px;
            height: 11px;
            fill: #727272;
        }

        .modal-body {
            border-top: 1px solid #ebebeb;
        }

        .perfomer {
            font-size: 24px;
            font-weight: bolder;
        }

        .event-info {
            font-size: 12px;
            margin-top: 15px;
        }

        .modal-date,
        .modal-venue {
            font-size: 14px;
        }

        .moda-datelocation {
            font-size: 12px;
        }

        .week {
            margin-bottom: 10px;
            margin-top: 2px;
        }

        .lineup {
            font-size: 15px;
            font-weight: bolder;
        }

        .card-performer {
            color: black;
            text-decoration: none;
        }

            .card-performer:hover {
                text-decoration: underline;
            }

        .modal-logo {
            font-size: 16px;
            font-weight: bolder;
            font-style: italic;
            padding: 10px;
            color: #727272;
        }

        .closebtn {
            fill: white;
        }

        .welcome-column {
            background-image: url(https://auth.ticketmaster.com/static/en-us/images/left-panel-image.png);
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
            overflow: hidden;
        }

        .welcome-body {
            width: 100%;
            height: 500px;
            padding: 0;
            border-top: none;
        }

        .welcome-title {
            color: rgb(0, 255, 255);
        }

        .welcome-text .text {
            color: white;
            font-size: 10px;
        }

        .welcome-underline::after {
            content: "";
            display: block;
            width: 64px;
            height: 4px;
            background: rgb(0, 255, 255);
        }

        .signin-title {
            font-size: 20px;
            font-weight: bolder;
        }

        .signin-main .new {
            color: rgb(38, 38, 38);
            font-size: 10px;
        }

        .signup-btn {
            color: rgb(2, 108, 223);
            font-size: 10px;
            font-weight: 600;
            padding: 0;
        }

        .email-address,
        .password-show {
            color: rgb(38, 38, 38);
            font-size: 10px;
        }

        .rem-me,
        .pass-btn {
            font-size: 14px;
        }

        .rem-me {
            color: #262626;
        }

        .pass-btn {
            color: rgb(2, 108, 223);
            font-weight: 600;
        }

        .By-memo {
            font-size: 12px;
        }

        .sign-term,
        .sign-privacy {
            color: #026cdf;
            text-decoration: none;
        }

        .signin-btn {
            background-color: #026cdf;
            border-radius: 0;
            color: white;
            font-size: 12px;
        }

        .modal-lg {
            margin-top: 10vh;
        }
        /* -------------------- */
        /* offcanvas-confirm */
        .picker__icon-plus {
            width: 18px;
            height: 18px;
            fill: #fff;
        }

        .card-seat .pic {
            width: 100%;
        }

            .card-seat .pic img {
                width: 100%;
                object-fit: contain;
                vertical-align: top;
            }

        .seat-text {
            font-size: 10px;
            color: #727272;
        }

        .tickets {
            border-top: 1px solid #ebebeb;
        }

        .ticket-price {
            font-size: 15px;
            font-weight: bolder;
        }

        .price-span {
            font-weight: 500;
            font-size: 12px;
        }

        .price-a {
            color: black;
        }

        .ticket-number {
            font-weight: bolder;
        }

        .btn-minus {
            width: 30px;
            height: 30px;
            border: none;
            border-radius: 50%;
            background-color: #727272;
            color: white;
        }

            .btn-minus:hover {
                background-color: black;
            }

        .btn-plus:hover {
            background-color: black;
        }

        .btn-plus {
            width: 30px;
            height: 30px;
            border: none;
            border-radius: 50%;
            background-color: #cce2f9;
            color: white;
        }

        .buy-text {
            font-size: 12px;
            font-weight: bolder;
        }

        .buynow-btn {
            background-color: white;
            border: 0;
            outline: 1px solid #ebebeb;
        }

            .buynow-btn:hover {
                transform: scale(1.1);
            }

        .subtotal {
            border-top: 1px solid #ebebeb;
        }

        .sub-text,
        .sub-price {
            font-size: 13px;
            font-weight: bolder;
        }

        .subtotal-ticket {
            font-size: 12px;
        }

        .next-btn {
            border: none;
            color: white;
            background-color: rgb(27, 171, 30);
            font-size: 13px;
            padding: 8px;
            font-weight: bolder;
            border-radius: 5px;
            margin-top: 10px;
        }

            .next-btn:hover {
                transform: scale(1.05);
            }
        /* --------------------------------- */
        /* Rounded Button */
        .switchs {
            position: relative;
            display: inline-block;
            border: 1px solid #ccc;
            border-radius: 500px;
            width: 60px;
            height: 34px;
        }

            .switchs input {
                opacity: 0;
                width: 0;
                height: 0;
            }

        .sliders {
            position: absolute;
            cursor: pointer;
            /* top: 0; */
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: 0.4s;
            transition: 0.4s;
        }

            .sliders:before {
                position: absolute;
                content: "";
                height: 26px;
                width: 26px;
                left: 4px;
                bottom: 4px;
                background-color: rgb(198, 198, 198);
                -webkit-transition: 0.4s;
                transition: 0.4s;
            }

        input:checked + .sliders {
            background-color: #2196f3 !important;
        }

        input:focus + .sliders {
            box-shadow: 0 0 1px #2196f3 !important;
        }

        input:checked + .sliders:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }

        /* Rounded sliders */
        /* .slider.round {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                border-radius: 34px;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              } */

        .sliders.round:before {
            border-radius: 50%;
        }
        /* Rounded Button */
        .typeOptions .accordion {
            position: static;
        }

        .typeOptions .accordion-item {
            border: none;
        }

        .applybtn,
        .resetbtn {
            color: #026cdf;
            border-radius: 5px;
        }

            .applybtn:hover {
                background-color: #026cdf;
                color: white;
            }

            .resetbtn:hover {
                background-color: #026cdf;
                color: white;
            }

        .ticketType {
            color: #727272;
        }

        .selectAll:hover {
            color: #026cdf;
        }

        .clearAll:hover {
            color: #026cdf;
        }

        .filter-btn .offcanvas {
            height: fit-content;
        }
        /*price-range*/
        .range-slider {
            height: 5px;
            position: relative;
            background-color: #e1e9f6;
            border-radius: 2px;
        }

        .range-selected {
            height: 100%;
            left: 30%;
            right: 30%;
            position: absolute;
            border-radius: 5px;
            background-color: #1b53c0;
        }

        .range-input {
            position: relative;
        }

            .range-input input {
                position: absolute;
                width: 100%;
                height: 5px;
                top: -7px;
                background: none;
                pointer-events: none;
                -webkit-appearance: none;
                -moz-appearance: none;
            }

                .range-input input::-webkit-slider-thumb {
                    height: 20px;
                    width: 20px;
                    border-radius: 50%;
                    border: 3px solid #1b53c0;
                    background-color: #fff;
                    pointer-events: auto;
                    -webkit-appearance: none;
                }

                .range-input input::-moz-range-thumb {
                    height: 15px;
                    width: 15px;
                    border-radius: 50%;
                    border: 3px solid #1b53c0;
                    background-color: #fff;
                    pointer-events: auto;
                    -moz-appearance: none;
                }

        .range-price {
            margin: 30px 0;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

            .range-price label {
                margin-right: 5px;
            }

            .range-price input {
                width: 60px;
                padding: 5px;
            }

                .range-price input:first-of-type {
                    margin-right: 15px;
                }
        /*price-range*/
        @@media screen and (max-width: 768px) {
            .widget-img {
                display: none;
            }

            .map-wrapper {
                flex-direction: column;
            }

            .map-container .accordion {
                display: none;
            }
        }
    </style>
</head>
<body>

    <!-- header -->
    <header class="col-12">
        <!-- navbar -->
        <nav class="navbar navbar-dark bg-primary pb-0 pt-0">
            <div class="container-fluid">
                <button class="btn btn-primary"
                        type="button"
                        data-bs-toggle="offcanvas"
                        data-bs-target="#offcanvasExample"
                        aria-controls="offcanvasExample"
                        aria-expanded="false"
                        aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                    <a class="text-light text-decoration-none ms-2 fs-3 fst-italic"
                       href="~/HomePage/HomePageView">ticketmonster</a>
                </button>

                <div class="user d-flex">
                    <div class="userlogo d-flex align-items-center justify-content-center">
                        <i class="fa-regular fa-user position-absolute text-white"></i>
                    </div>
                    <div class="signin ms-2">
                        @if (_userManger.IsLoggingIn())
                        {
                            @await Html.PartialAsync("_LoggingInPartial")
                        }
                        else
                        {
                            <a class="nav-link text-decoration-none sign-in" data-bs-toggle="modal"
                               data-bs-target="#signinModal">Sign In</a>
                            <partial name="_SignIn" model="Model.customer" />
                        }

                    </div>
                </div>
            </div>
        </nav>
        <!-- 滑出視窗 -->
        <div class="offcanvas offcanvas-start"
             tabindex="-1"
             id="offcanvasExample"
             aria-labelledby="offcanvasExampleLabel">
            <div class="offcanvas-header">
                <button type="button"
                        class="btn-close"
                        data-bs-dismiss="offcanvas"
                        aria-label="Close"></button>
            </div>
            <div class="offcanvas-body mt-2 lh-lg">
                <div class="input-group mb-3">
                    <form class="d-flex w-100" role="search" action="~/Search" method="get">
                        <input id="keyword" name="keyword" class="form-control" type="search" placeholder="Search Artist, Team or Venue" aria-label="Search">
                        <button class="btn" id="button-addon2" type="submit"><i class="fa-solid fa-magnifying-glass"></i></button>
                    </form>
                    @*<form class="d-flex input-group pr-5" action="~/Search" method="get">
                    <input id="keyword" name="keyword" class="form-control me-2" type="search" placeholder="Search Events" aria-label="Search">
                    </form>*@
                </div>
                <div class="help-group mt-4">
                    <div class="help">We're Here to Help</div>
                    <div class="getHelp">
                        <a class="get-help text-decoration-none text-bg-light"
                           href="https://help.ticketmaster.com/hc/en-us/?tm_link=tm_i_help&_gl=1*1ssy5n7*_gcl_au*MTAwODM5MjY0LjE2OTEwNDAxMTA.*_ga*MjA5MjUwMzAyMS4xNjkwMzc4NzI1*_ga_H1KKSGW33X*MTY5MTA1NTIwNC4xMi4wLjE2OTEwNTUyMDQuNjAuMC4w&_ga=2.183159456.788170351.1691039879-2092503021.1690378725">Get Help</a>
                    </div>
                    <div class="insider">
                        <a class="inside text-decoration-none text-bg-light"
                           href="https://blog.ticketmaster.com/?tm_link=tm_i_insider&_gl=1%2A1xb2j61%2A_gcl_au%2AMTAwODM5MjY0LjE2OTEwNDAxMTA.%2A_ga%2AMjA5MjUwMzAyMS4xNjkwMzc4NzI1%2A_ga_H1KKSGW33X%2AMTY5MTA1NTIwNC4xMi4xLjE2OTEwNTY2NTIuNDkuMC4w&_ga=2.154846526.788170351.1691039879-2092503021.1690378725">Insider</a>
                    </div>
                </div>
                <div class="friend-partners mt-5">
                    <div class="fri-text">Friends & Partners</div>
                    <div class="fri-pic">
                        <a href="https://www.paypal.com/tw/home">
                            <img class="paypalpic"
                                 src="data:image/svg+xml,%3Csvg width='75' height='20' viewBox='0 0 75 20' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cg clip-path='url(%23clip0_1226_90534)'%3E%3Cpath d='M27.3761 12.1164C29.6262 12.1164 31.5363 10.468 31.8856 8.23359C32.2373 5.98047 30.4852 4.01641 28.0009 4.01172H23.9986C23.8446 4.01172 23.7131 4.12422 23.689 4.27734L21.9026 15.6508C21.8746 15.8273 22.0107 15.9875 22.1889 15.9875H24.3075C24.4616 15.9875 24.5931 15.875 24.6172 15.7219L25.1416 12.382C25.1657 12.2289 25.2972 12.1164 25.4512 12.1164H27.3769H27.3761ZM29.1485 8.13359C29.0178 8.96641 28.3767 9.57969 27.1497 9.57969H25.5812L26.0565 6.55078H27.5971C28.8661 6.55078 29.2784 7.30234 29.1485 8.13359Z' fill='%23003087'/%3E%3Cpath d='M41.0628 7.597H39.0523C38.8983 7.597 38.7668 7.7095 38.7427 7.86263L38.6766 8.28138C38.6766 8.28138 37.1158 6.56888 34.3522 7.72513C32.7673 8.38841 32.0064 9.7595 31.6827 10.7587C31.6827 10.7587 30.6542 13.8079 32.979 15.4837C32.979 15.4837 35.1341 17.0962 37.5608 15.3837L37.5188 15.6509C37.4908 15.8275 37.627 15.9876 37.8051 15.9876H39.8156C39.9697 15.9876 40.1011 15.8751 40.1253 15.722L41.3483 7.93294C41.3764 7.75638 41.2402 7.59622 41.062 7.59622L41.0628 7.597ZM38.1078 11.9017C37.932 13.0189 37.0201 13.8415 35.8499 13.8415C35.6189 13.8415 35.4072 13.8095 35.2182 13.7486C34.3506 13.4689 33.8558 12.6322 33.9982 11.7251C34.174 10.6079 35.089 9.78528 36.2584 9.78528C36.4895 9.78528 36.7011 9.81731 36.8902 9.87825C37.7577 10.1579 38.2494 10.9947 38.107 11.9017H38.1078Z' fill='%23003087'/%3E%3Cpath d='M56.3341 12.1164C58.5842 12.1164 60.4943 10.468 60.8436 8.23359C61.1953 5.98047 59.4432 4.01641 56.9589 4.01172H52.9566C52.8026 4.01172 52.6711 4.12422 52.647 4.27734L50.8606 15.6508C50.8326 15.8273 50.9687 15.9875 51.1469 15.9875H53.2655C53.4196 15.9875 53.5511 15.875 53.5752 15.7219L54.0996 12.382C54.1237 12.2289 54.2552 12.1164 54.4092 12.1164H56.3349H56.3341ZM58.1065 8.13359C57.9758 8.96641 57.3347 9.57969 56.1077 9.57969H54.5392L55.0146 6.55078H56.5551C57.8241 6.55078 58.2364 7.30234 58.1065 8.13359Z' fill='%230070E0'/%3E%3Cpath d='M70.0203 7.597H68.0099C67.8558 7.597 67.7243 7.7095 67.7002 7.86263L67.6341 8.28138C67.6341 8.28138 66.0733 6.56888 63.3097 7.72513C61.7249 8.38841 60.9639 9.7595 60.6403 10.7587C60.6403 10.7587 59.6117 13.8079 61.9365 15.4837C61.9365 15.4837 64.0917 17.0962 66.5184 15.3837L66.4763 15.6509C66.4483 15.8275 66.5845 15.9876 66.7627 15.9876H68.7731C68.9272 15.9876 69.0587 15.8751 69.0828 15.722L70.3059 7.93294C70.3339 7.75638 70.1977 7.59622 70.0195 7.59622L70.0203 7.597ZM67.0653 11.9017C66.8895 13.0189 65.9776 13.8415 64.8074 13.8415C64.5764 13.8415 64.3647 13.8095 64.1757 13.7486C63.3082 13.4689 62.8133 12.6322 62.9557 11.7251C63.1315 10.6079 64.0465 9.78528 65.2159 9.78528C65.447 9.78528 65.6586 9.81731 65.8477 9.87825C66.7152 10.1579 67.2069 10.9947 67.0645 11.9017H67.0653Z' fill='%230070E0'/%3E%3Cpath d='M48.444 7.79063L46.0204 11.8992L44.7903 7.82109C44.7507 7.68828 44.6285 7.59766 44.4908 7.59766H42.3037C42.1442 7.59766 42.0314 7.75391 42.0804 7.90625L44.2846 14.7758L42.2913 18.0133C42.1948 18.1703 42.3068 18.3734 42.4912 18.3734H44.8471C44.9841 18.3734 45.1117 18.3016 45.1825 18.1836L51.3391 7.95625C51.434 7.79922 51.3212 7.59844 51.1384 7.59844H48.7825C48.644 7.59844 48.5164 7.67188 48.4456 7.79141L48.444 7.79063Z' fill='%23003087'/%3E%3Cpath d='M72.2822 4.27734L70.4959 15.6508C70.4678 15.8273 70.604 15.9875 70.7822 15.9875H72.9C73.054 15.9875 73.1855 15.875 73.2097 15.7219L74.996 4.34844C75.024 4.17188 74.8879 4.01172 74.7097 4.01172H72.5919C72.4378 4.01172 72.3064 4.12422 72.2822 4.27734Z' fill='%230070E0'/%3E%3Cpath d='M15.907 9.20625C15.4518 11.8125 13.3332 13.7836 10.5556 13.7836H8.79104C8.43081 13.7828 8.06902 14.118 8.00911 14.4867L7.23574 19.4109C7.19139 19.6906 7.06068 19.7844 6.77747 19.7844H3.94229C3.65598 19.7844 3.58751 19.6883 3.63263 19.4039L3.95396 16.0008L0.547703 15.8242C0.261384 15.8242 0.153237 15.6641 0.198363 15.3805L2.52159 0.580469C2.56594 0.3 2.73944 0.179688 3.02187 0.179688H8.91631C11.7538 0.179688 13.5488 2.09766 13.7689 4.58438C15.4596 5.73203 16.2486 7.25469 15.9078 9.20625H15.907Z' fill='%23001C64'/%3E%3Cpath d='M4.81906 10.4875L3.9531 16.0008L3.41003 19.4594C3.36568 19.7438 3.58431 20.0008 3.87063 20.0008H6.86686C7.14929 20.0008 7.38971 19.7945 7.43405 19.5141L8.22377 14.4875C8.26811 14.207 8.50853 14.0008 8.79096 14.0008H10.5556C13.3339 14.0008 15.6914 11.9656 16.1224 9.20781C16.4282 7.25 15.4471 5.46875 13.7689 4.58594C13.765 4.79062 13.7471 4.99844 13.7144 5.20781C13.2834 7.96563 10.9259 10.0008 8.14752 10.0008H5.38703C5.1046 10.0008 4.86419 10.207 4.81984 10.4875H4.81906Z' fill='%230070E0'/%3E%3Cpath d='M3.95322 16H0.46682C0.180501 16 -0.0381279 15.743 0.00622037 15.4586L2.35746 0.486719C2.40181 0.20625 2.64222 0 2.92465 0H8.91634C11.7539 0 13.8172 2.07344 13.769 4.58437C13.0633 4.2125 12.2339 4 11.3252 4H6.32858C6.04615 4 5.80573 4.20625 5.76139 4.48672L4.81918 10.4867L3.95322 16Z' fill='%23003087'/%3E%3C/g%3E%3Cdefs%3E%3CclipPath id='clip0_1226_90534'%3E%3Crect width='75' height='20' fill='white'/%3E%3C/clipPath%3E%3C/defs%3E%3C/svg%3E%0A"
                                 alt="PayPal" />
                        </a>
                    </div>
                </div>
                <div class="downloadApps mt-5">
                    <div class="download-text">Download Our Apps</div>
                    <div class="download-pic">
                        <a href="https://apps.apple.com/us/app/ticketmaster/id500003565">
                            <img class="appstore"
                                 src="https://ccp.tmconst.com/tm/6ff0af4d/static/ccp/img/svg/app_store_badge_en.svg"
                                 alt="App Store" />
                        </a>
                        <a href="https://play.google.com/store/apps/details?id=com.ticketmaster.mobile.android.na">
                            <img class="googleplay"
                                 src="https://ccp.tmconst.com/tm/6ff0af4d/static/ccp/img/svg/google-play-badge_en.svg"
                                 alt="Google Play" />
                        </a>
                    </div>
                </div>
                <div class="span mt-5">
                    <span class="spantext">© 1999-2023 Ticketmonster. All rights reserved.</span>
                </div>
            </div>
        </div>

        <!-- 第二個橫幅 -->
        <div class="widget d-flex">
            <div class="widget-pic p-2">
                <img class="widget-img"
                     src="@Model.EventsViewModel.EventPic"
                     alt="Artist" />
            </div>
            <div class="widget-text mt-2">
                <div class="widget-title d-flex text-light align-items-center mt-2">

                    @Model.EventsViewModel.EventName
                    <div class="info-btn">
                        <button type="button"
                                class="btn btn-outline-light infobtn ms-2"
                                data-bs-toggle="modal"
                                data-bs-target="#exampleModal">
                            More Info
                        </button>

                        <!-- Modal -->
                        <div class="modal fade"
                             id="exampleModal"
                             tabindex="-1"
                             aria-labelledby="exampleModalLabel"
                             aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header bg-primary">
                                        <h1 class="modal-title fs-6 m-auto"
                                            id="exampleModalLabel">
                                            More Info
                                        </h1>
                                        <button type="button"
                                                class="btn-close closebtn"
                                                data-bs-dismiss="modal"
                                                aria-label="Close"></button>
                                    </div>
                                    <div class="modal-logo">ticketmonster</div>
                                    <div class="modal-body">
                                        @foreach (var item in Model.PerformersViewModel.Name)
                                        {
                                            <h2 class="perfomer">@item</h2>
                                        }


                                        <div class="event-info">
                                            <strong>Important Event Info:</strong> Our Ticketmaster
                                            resale marketplace is not the primary ticket provider.
                                            Resale tickets can often exceed face value.
                                        </div>
                                    </div>
                                    <div class="modal-body d-flex">
                                        <div class="modal-datevenue d-flex flex-column">
                                            <div class="modal-date d-flex gap-1 mb-1">
                                                <div class="date-pic">
                                                    <img src="data:image/svg+xml,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Ctitle%3Etimer%3C%2Ftitle%3E%3Cpath%20d%3D%22M10%200C4.477%200%200%204.478%200%2010c0%205.523%204.477%2010%2010%2010s10-4.477%2010-10c0-5.522-4.477-10-10-10zm0%2017.144c-3.946%200-7.143-3.198-7.143-7.144%200-3.943%203.197-7.143%207.143-7.143%203.946%200%207.142%203.2%207.142%207.143%200%203.946-3.196%207.144-7.142%207.144zm4.923-9.382l-4.21%202.43V4.288H9.288v8.38l1.427-.826L15.638%209l-.715-1.238z%22%20fill%3D%22%23262626%22%20fill-opacity%3D%220.65%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E"
                                                         alt="clock" />
                                                </div>
                                                <strong>Date</strong>
                                            </div>
                                            <div class="modal-venue d-flex align-items-center ms-1 gap-2">
                                                <div class="venue-pic">
                                                    <img src="data:image/svg+xml,%3Csvg%20width%3D%2212%22%20height%3D%2220%22%20viewBox%3D%220%200%2012%2020%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Ctitle%3Epin_gr%3C%2Ftitle%3E%3Cpath%20d%3D%22M12%206.154C12%202.756%209.314%200%206%200S0%202.755%200%206.154c0%201.122.298%202.17.81%203.077H.804L6%2020l5.197-10.77h-.007c.513-.905.81-1.954.81-3.076zM6%209.23c-1.657%200-3-1.378-3-3.077%200-1.7%201.343-3.077%203-3.077s3%201.377%203%203.077S7.657%209.23%206%209.23z%22%20fill%3D%22%23262626%22%20fill-opacity%3D%220.65%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E"
                                                         alt="tag" />
                                                </div>
                                                <strong>Venue</strong>
                                            </div>
                                        </div>
                                        <div class="moda-datelocation ms-3 d-flex flex-column justify-content-center">
                                            <div class="week">@Model.EventsViewModel.EventDate - @Model.EventsViewModel.TotalTime</div>
                                            <div class="location">
                                                @Model.VenuesViewModel.Location
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer d-flex flex-column align-items-baseline">
                                        <h3 class="lineup">Lineup</h3>
                                        <div class="card" style="width: 18rem">

                                            <img src="@Model.PerformersViewModel.PerformerPic" class="card-img-top" alt="" />





                                            <div class="card-body m-auto">
                                                @foreach (var item in Model.PerformersViewModel.Name)
                                                {
                                                    <a class="card-performer" href="#">@item</a>
                                                }

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="widget-info mt-4 pb-3">
                    <p class="widgetdate text-light">@Model.EventsViewModel.EventDate</p>

                    <a class="widgetarea text-decoration-none text-light" href="">@Model.VenuesViewModel.Location</a>
                </div>
            </div>
        </div>
    </header>

    <!-- 主區塊 -->
    <div class="container-fluid cf">
        <div class="row">
            <div class="map">
                <div class="map-wrapper d-flex">
                    <!-- 場館主圖區 -->
                    <div class="map-container col-12 col-md-9 col-lg-9 overflow-hidden">
                        <div class="zoomer">
                            <div class="pic">
                                @Html.Raw(@Model.VenuesViewModel.Pic)
                                <div id="app"></div>
                            </div>
                            <div class="zoomer-controls d-flex flex-column">
                                <button class="btn reset" onclick="refresh()">
                                    <i class="fa-solid fa-rotate-left"></i>
                                </button>
                                <button class="btn zoomin" onclick="zoomIn()">
                                    <i class="fa-solid fa-plus"></i>
                                </button>
                                <button class="btn zoomout" onclick="zoomOut()">
                                    <i class="fa-solid fa-minus"></i>
                                </button>
                            </div>
                            <div class="accordion" id="accordionExample">
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button"
                                                type="button"
                                                data-bs-toggle="collapse"
                                                data-bs-target="#collapseOne"
                                                aria-expanded="true"
                                                aria-controls="collapseOne">
                                            Legend
                                        </button>
                                    </h2>
                                    <div id="collapseOne"
                                         class="accordion-collapse collapse show"
                                         data-bs-parent="#accordionExample">
                                        <div class="accordion-body pb-0">
                                            <ul class="list-unstyledd">
                                                <div class="ava d-flex align-items-center gap-2">
                                                    <svg viewBox="0 0 100 100">
                                                        <g><circle cx="50" cy="50" r="50"></circle></g>
                                                    </svg>
                                                <li>Available</li>
                                        </div>
                                        <div class="loc d-flex align-items-center gap-2">
                                            <svg viewBox="0 0 100 100">
                                                <g>
                                                    <circle cx="50" cy="50" r="50"></circle>
                                                    <path d="M68.86,36.57H63.71V28a12,12,0,0,0-12-12H48.29a12,12,0,0,0-12,12v8.57H31.14A5.15,5.15,0,0,0,26,41.71V72.57a5.15,5.15,0,0,0,5.14,5.14H68.86A5.15,5.15,0,0,0,74,72.57V41.71A5.15,5.15,0,0,0,68.86,36.57ZM39.71,28a8.58,8.58,0,0,1,8.57-8.57h3.43A8.58,8.58,0,0,1,60.29,28v8.57H39.71V28ZM50,65a7.84,7.84,0,1,1,7.84-7.84A7.84,7.84,0,0,1,50,65Z"></path>
                                                </g>
                                            </svg>
                                            <li>Locked Offer</li>
                                        </div>
                                        <div class="acc d-flex align-items-center gap-2">
                                            <svg viewBox="0 0 100 100">
                                                <g>
                                                    <circle cx="50" cy="50" r="50"></circle>
                                                    <path d="M62.34,55.7825 C65.0175,62.15 67.7475,68.495 70.455,74.855 C70.56,75.0875 70.65,75.32 70.7925,75.62 C71.0025,75.545 71.235,75.47 71.4375,75.395 C74.865,74.045 78.2925,72.71 81.72,71.36 C81.8775,71.285 82.0575,71.2475 82.215,71.2025 L82.215,71.075 C81.6225,69.695 81.03,68.3525 80.43,66.9425 C78.3075,67.7225 76.215,68.465 74.0625,69.245 C73.95,69.035 73.8675,68.8325 73.7775,68.645 C71.1225,62.5475 68.4825,56.4425 65.8575,50.33 C65.67,49.88 65.4375,49.73 64.95,49.745 C58.7925,49.7975 52.62,49.82 46.425,49.865 C46.2525,49.865 46.08,49.8575 45.8625,49.835 C45.7725,48.62 45.675,47.435 45.5775,46.1825 L59.835,46.1825 L59.835,40.775 L45.0525,40.775 C44.82,36.845 44.61,32.9825 44.385,29.09 C44.73,29.015 45.0375,28.9625 45.33,28.88 C47.925,28.19 49.68,25.775 49.5975,23.015 C49.5225,20.435 47.5575,18.1325 44.985,17.6075 C44.835,17.5775 44.6925,17.525 44.535,17.4875 L43.125,17.4875 C42.9225,17.54 42.705,17.6 42.51,17.6525 C39.105,18.4775 37.23,22.04 38.4075,25.34 C38.655,26 38.8125,26.7275 38.865,27.44 C39.345,34.01 39.81,40.58 40.275,47.15 C40.44,49.61 40.6275,52.055 40.7625,54.5 C40.8,55.0475 40.9575,55.1975 41.49,55.1825 C48.1275,55.1675 54.765,55.1825 61.3875,55.1675 C61.8975,55.16 62.145,55.295 62.34,55.7825 Z M25.335,59.39 L25.335,62.9225 C25.365,63.0725 25.425,63.23 25.4325,63.38 C26.46,72.6125 33.045,80.015 42.1275,82.0475 C42.915,82.2275 43.74,82.355 44.535,82.5125 L48.66,82.5125 C49.8525,82.2725 51.06,82.115 52.23,81.77 C58.0575,80.0975 62.505,76.61 65.4975,71.3 C65.7,70.94 65.715,70.6625 65.5425,70.2725 C64.4475,68.12 63.405,65.945 62.3475,63.7775 C62.2425,63.59 62.1525,63.425 62.0325,63.1925 C61.8525,63.965 61.71,64.6625 61.53,65.345 C59.5125,72.38 53.07,77.045 45.7875,76.7375 C38.2725,76.4 31.8,70.2275 31.2075,62.7125 C30.735,56.7125 33,51.905 37.8825,48.35 C38.04,48.23 38.2275,47.99 38.22,47.825 C38.0925,45.86 37.935,43.9025 37.7775,41.855 C37.5525,41.945 37.35,42.005 37.17,42.1025 C30.375,45.7175 26.4525,51.3425 25.4475,58.9925 C25.425,59.1275 25.365,59.24 25.335,59.39 Z"></path>
                                                </g>
                                            </svg>
                                            <li>Accessiblity</li>
                                        </div>
                                        <div class="una d-flex align-items-center gap-2">
                                            <svg viewBox="0 0 100 100">
                                                <g><circle cx="50" cy="50" r="50"></circle></g>
                                            </svg>
                                            <li>Unavailable</li>
                                        </div>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="under-memo">
                        By continuing past this page, you agree to our
                        <a class="text-decoration-none terms" href="#">Terms of Use</a>
                        <a class="text-decoration-none cookie" href="#">| Cookie Preferences</a>
                        <span>@@Ticketmaster 2023.</span>
                    </div>
                </div>
                <!-- 右邊票卷過濾 -->
                <div class="col-12 col-lg-3 col-md-3 ticketsite position-relative">
                    <div class="btn-filter">
                        <div class="btn-group d-flex mt-2 w-100 ps-2 pe-2">
                            <div class="dropdown-div col-6">
                                <div class="dropdown d-flex justify-content-center">
                                    <select id="select1" class="form-select form-control  text-center border-primary text-primary"
                                            aria-label="Select Ticket">
                                        <option hidden>1 Ticket</option>
                                        <option value="1">1 Ticket</option>
                                        <option value="2">2 Ticket</option>
                                        <option value="3">3 Ticket</option>
                                        <option value="4">4 Ticket</option>
                                        <option value="5">5 Ticket</option>
                                        <option value="6">6 Ticket</option>
                                        <option value="7">7 Ticket</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filterbtn-group d-flex col-6 ps-2">
                                <div class="filter-btn w-100 d-flex justify-content-center">
                                    <button type="button"
                                            class="btn filterbtn d-flex align-items-center gap-1 w-100 justify-content-center"
                                            data-bs-toggle="offcanvas"
                                            data-bs-target="#offcanvasFilter"
                                            aria-controls="offcanvasFilter">
                                        <i class="fa-solid fa-arrow-down-wide-short"></i>
                                        Filters
                                    </button>
                                    <div class="offcanvas offcanvas-end position-absolute w-100"
                                         data-bs-scroll="true"
                                         data-bs-backdrop="false"
                                         tabindex="-1"
                                         id="offcanvasFilter"
                                         aria-labelledby="offcanvasFilterLabel">
                                        <div class="offcanvas-header d-flex border-bottom">
                                            <button type="button"
                                                    class="btn-close"
                                                    data-bs-dismiss="offcanvas"
                                                    aria-label="Close"></button>
                                            <h5 class="offcanvas-title m-auto fw-bolder"
                                                id="offcanvasFilterLabel">
                                                Filters
                                            </h5>
                                        </div>
                                        <div class="offcanvas-body d-flex flex-column justify-content-between">
                                            <div class="canvasUpper">
                                                <div class="dropdown-div col-12">
                                                    <div class="dropdown d-flex justify-content-center">
                                                        <select id="select2" class="form-select form-control  text-center border-primary text-primary"
                                                                aria-label="Select Ticket">
                                                            <option hidden>1 Ticket</option>
                                                            <option value="1">1 Ticket</option>
                                                            <option value="2">2 Ticket</option>
                                                            <option value="3">3 Ticket</option>
                                                            <option value="4">4 Ticket</option>
                                                            <option value="5">5 Ticket</option>
                                                            <option value="6">6 Ticket</option>
                                                            <option value="7">7 Ticket</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="price-range mt-3">
                                                    <div class="range">
                                                        <div class="range-slider">
                                                            <span class="range-selected"></span>
                                                        </div>
                                                        <div class="range-input">
                                                            <input type="range" class="min" min="0" max="1000" value="300" step="10">
                                                            <input type="range" class="max" min="0" max="1000" value="700" step="10">
                                                        </div>
                                                        <div class="range-price">
                                                            <label for="min">Min</label>
                                                            <input type="number" name="min" value="300">
                                                            <label for="max">Max</label>
                                                            <input type="number" name="max" value="700">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="ticketType d-flex justify-content-between">
                                                    <p class="m-auto ms-0 ml-0 ticketType">
                                                        Ticket Type
                                                    </p>
                                                    <div class="btn-group">
                                                        <button class="selectAll btn">
                                                            Select All
                                                        </button><span class="m-auto">|</span><button class="clearAll btn">Clear All</button>
                                                    </div>
                                                </div>
                                                <div class="typeOptions d-flex">
                                                    <div class="col-12 mt-4">
                                                        <div class="accordion">
                                                            <div class="accordion-item">
                                                                <h2 class="accordion-header">
                                                                    <button class="accordion-button"
                                                                            type="button"
                                                                            data-bs-toggle="collapse"
                                                                            data-bs-target="#OptionsOne"
                                                                            aria-expanded="true"
                                                                            aria-controls="OptionsOne">
                                                                        <input type="checkbox" id="check1"
                                                                               class="mx-2 ms-0" />
                                                                        General Admission Tickets
                                                                    </button>
                                                                </h2>
                                                                <div id="OptionsOne"
                                                                     class="accordion-collapse collapse"
                                                                     data-bs-parent="#accordionExample">
                                                                    <div class="accordion-body">Choose from a range of standard tickets. Based on demand, the price of tickets may change. </div>
                                                                </div>
                                                            </div>
                                                            <div class="accordion-item">
                                                                <h2 class="accordion-header">
                                                                    <button class="accordion-button collapsed"
                                                                            type="button"
                                                                            data-bs-toggle="collapse"
                                                                            data-bs-target="#OptionsTwo"
                                                                            aria-expanded="false"
                                                                            aria-controls="OptionsTwo">
                                                                        <input type="checkbox" id="check2"
                                                                               class="mx-2 ms-0" />
                                                                        Reserved Seating Tickets
                                                                    </button>
                                                                </h2>
                                                                <div id="OptionsTwo"
                                                                     class="accordion-collapse collapse"
                                                                     data-bs-parent="#accordionExample">
                                                                    <div class="accordion-body">Reserved seating is a type of ticket that allows you to choose and reserve a specific seat at an event ahead of time. With a reserved seating ticket, you know exactly where you will be sitting and can plan your arrival accordingly.</div>
                                                                </div>
                                                            </div>
                                                            <div class="accordion-item">
                                                                <h2 class="accordion-header">
                                                                    <button class="accordion-button collapsed"
                                                                            type="button"
                                                                            data-bs-toggle="collapse"
                                                                            data-bs-target="#OptionsThree"
                                                                            aria-expanded="false"
                                                                            aria-controls="OptionsThree">
                                                                        <input type="checkbox" id="check3"
                                                                               class="mx-2 ms-0" />
                                                                        VIP Tickets
                                                                    </button>
                                                                </h2>
                                                                <div id="OptionsThree"
                                                                     class="accordion-collapse collapse"
                                                                     data-bs-parent="#accordionExample">
                                                                    <div class="accordion-body">
                                                                        Some events offer fans VIP packages allowing them the opportunity to have a unique live experience. From front-row seats to soundchecks and meet-and-greets, every package is tailored, ensuring you have a truly memorable time.
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="accordion-item">
                                                                <h2 class="accordion-header">
                                                                    <button class="accordion-button collapsed"
                                                                            type="button"
                                                                            data-bs-toggle="collapse"
                                                                            data-bs-target="#OptionsFourth"
                                                                            aria-expanded="false"
                                                                            aria-controls="OptionsFourth">
                                                                        <input type="checkbox" id="check4"
                                                                               class="mx-2 ms-0" />
                                                                        Resale Tickets
                                                                    </button>
                                                                </h2>
                                                                <div id="OptionsFourth"
                                                                     class="accordion-collapse collapse"
                                                                     data-bs-parent="#accordionExample">
                                                                    <div class="accordion-body">
                                                                        Resale Tickets are available for this event. This is a ticket resale service. These are tickets sold by fans and verified by Ticketmaster. Ticket type and other ticket details for Resale Tickets can be found on the checkout page. Please review this carefully.
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="accessiblebutton d-flex justify-content-between mt-4 m-auto">
                                                    <p>Show Accessible Tickets</p>
                                                    <label class="switchs d-flex">
                                                        <input class="roundBtn"
                                                               type="checkbox"
                                                               checked />
                                                        <span class="sliders round"></span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="canvasDown d-flex justify-content-end">
                                                <div class="btn-group">
                                                    <button class="btn applybtn" data-bs-dismiss="offcanvas">
                                                        Apply Filters
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="memo mt-3">
                        <div class="memo-text text-justify">
                            An order processing fee of up to $6.00 may be added to each
                            order. Any applicable taxes will be added at checkout.
                        </div>
                    </div>
                    <div class="lower-price d-flex justify-content-center mt-1 pb-1">
                        <a class="lowerPrice text-decoration-none" href="">Lowest Price</a>
                    </div>
                    <div class="price-detail">
                        <ul class="list-unstyled">
                                @*<partial name="_SeatListPartial" model="Model" />*@

                            <div class="offcanvas offcanvas-end position-absolute w-100"
                                 data-bs-scroll="true"
                                 data-bs-backdrop="false"
                                 tabindex="-1"
                                 id="offcanvasScrolling"
                                 aria-labelledby="offcanvasScrollingLabel">
                                <div class="offcanvas-header p-0">
                                    <div class="container-confirmed d-flex flex-column w-100">
                                        <div class="confirmed-header d-flex bg-body-secondary p-2">
                                            <div class="seat-num col-11 d-flex justify-content-center">
                                                <p class="seatText m-auto"></p>
                                            </div>
                                            <div class="close-btn col-1 d-flex justify-content-end">
                                                <button type="button"
                                                        class="btn-close"
                                                        data-bs-dismiss="offcanvas"
                                                        aria-label="Close"></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="offcanvas-body d-flex justify-content-between flex-column">
                                    <div class="tikets-detail">
                                        <div class="card-seat d-flex align-items-center">
                                            <div class="pic">
                                                    @Html.Raw(@Model.VenuesViewModel.Pic)
                                            </div>
                                            <div class="seat-text">
                                                <p class="seatText2 m-auto"></p>
                                            </div>
                                        </div>
                                        <div class="seat-memo ps-2 mb-2">
                                            <i class="fa-solid fa-circle-info p-2"></i>You'll get
                                            2 tickets together in this row.
                                        </div>
                                        <div class="tickets d-flex ps-2 pt-2 justify-content-between">
                                            <div class="ticket-price col-8">
                                                Resale Tickets <br />
                                                <span class="price-span">

                                                    <a class="text-decoration-none price-a" href="#">+ Fees</a>
                                                </span>
                                            </div>
                                            <div class="ticket-number d-flex">
                                                <button class="btn-minus">-</button>
                                                <p class="numValue ms-2 me-2 mt-1">1</p>
                                                <button class="btn-plus">+</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="container-buy">
                                        <div class="buynow m-3">
                                            <button class="buynow-btn d-flex w-100 justify-content-between">
                                                <div class="card-text-buynow d-flex ps-1">
                                                    <div class="buynow-pic">
                                                        <img src="https://ccp.tmconst.com/tm/6ff0af4d/static/ccp/flexpay/flexpay-icon.svg"
                                                             alt="card" />
                                                    </div>
                                                    <div class="buy-text ps-2 m-auto">
                                                        Buy Now, Pay Later at Checkout
                                                    </div>
                                                </div>
                                                <div class="buynow-icon d-flex pt-2">
                                                    <i class="fa-solid fa-circle-info"></i>
                                                </div>
                                            </button>
                                        </div>
                                        <div class="confirmed-footer">
                                            <div class="subtotal">
                                                <div class="subtotal-price d-flex justify-content-between">
                                                    <div class="sub-text mt-2 ps-3">Subtotal</div>
                                                    <div class="sub-price mt-2 pe-3">$119.00</div>
                                                </div>
                                                <div class="subtotal-ticket ps-3"><span class="numValue2">1</span> tickets</div>
                                            </div>
                                            <div class="next mx-3">
                                                <a href="~/CheckOut/@Model.EventsViewModel.ID" class="">
                                                        @*可以取到id的方法*@
                                                        @* <a asp-controller="CheckOutPage" asp-action="CheckOutPageView"> *@
                                                        @* </a> *@
                                                    <button class="w-100 next-btn">Next</button>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <script asp-append-version="true">

        //#region Variable定義變數
        //filterItems
        var ticketList = document.querySelector(".list-unstyled")
        var svg = document.getElementById("Layer_1")
        var purchaseNum = document.querySelector(".numValue");
        var purchaseNum2 = document.querySelector(".numValue2");
        var minusBtn = document.querySelector(".btn-minus")
        var plusBtn = document.querySelector(".btn-plus")

        //selectListItem
        var selectList1 = document.getElementById("select1");
        var selectList2 = document.getElementById("select2");

        //filterCheckbox
        var selAllBtn = document.querySelector(".selectAll");
        var cleAllBtn = document.querySelector(".clearAll");
        var checkBox1 = document.getElementById("check1")
        var checkBox2 = document.getElementById("check2")
        var checkBox3 = document.getElementById("check3")
        var checkBox4 = document.getElementById("check4")

        //purchase confirm textContent
        var currentNum = selectList1.value.match(/\d+/)[0];
        var seatPriceList = document.querySelector(".price-delist")
        var seatNum = document.querySelector(".seatText")
        var seatNum2 = document.querySelector(".seatText2")
        var priceSpan = document.querySelector(".price-span")
        var subPrice = document.querySelector(".sub-price")
        var perPrice;

        //Price-Range
        let rangeMin = 100;
        const range = document.querySelector(".range-selected");
        const rangeInput = document.querySelectorAll(".range-input input");
        const rangePrice = document.querySelectorAll(".range-price input");

        //seatJson file
        var seatListArray = @Html.Raw(seatJson);
        var sectionListArray = @Html.Raw(seatSectionJson);
        var seatLA = JSON.parse(seatListArray);
        var sectionLA = JSON.parse(sectionListArray);

        //venue SVG

        //Get TheaterSeatNum IsOrdered=true
        const apiUrl = 'api/PurchaseApi/GetTheaterSeat'
        // #endregion

        window.onload = function () {
            clearAllCookies();
        }

        // #region filterRender
        selectList1.addEventListener("change", () => {
            selectList2.value = selectList1.value;
            purchaseNum.textContent = selectList1.value.match(/\d+/)[0];
            purchaseNum2.textContent = purchaseNum.textContent
        })

        // #endregion

        // #region ImageZoomIn&Out

        var pic = document.getElementById("Layer_1");
        var originalWidth = pic.clientWidth;
        var Width = originalWidth;
        function refresh() {
            Width = originalWidth;
            pic.style.width = Width + "px"
            pic.style.transformOrigin = "50% 50%";
        }
        function zoomIn() {
            Width += 100;
            pic.style.width = Width + 100 + "px";
            pic.style.transformOrigin = "50% 50%";
        }

        function zoomOut() {
            Width -= 100;
            pic.style.width = Width - 100 + "px";
            pic.style.transformOrigin = "50% 50%";
        }
        let moving;
        //  滑鼠點下，開始拖拉
        function mouseDown(e) {
            moving = true;
        }
        //  拖拉的移動過程

        function drag(e) {
            if (moving === true) {
                // 1. 取得一開始的 viewBox 值，原本是字串，拆成陣列，方便之後運算
                let startViewBox = svg
                    .getAttribute("viewBox")
                    .split(" ")
                    .map((n) => parseFloat(n));

                //  2. 取得滑鼠當前 viewport 中 client 座標值
                let startClient = {
                    x: e.clientX,
                    y: e.clientY,
                };

                //  3. 計算對應回去的 SVG 座標值
                //SVG的API，用於座標轉換，將滑鼠座標轉換成SVG空
                // 間座標
                let newSVGPoint = svg.createSVGPoint();
                //CTM是矩陣，用於計算SVG元素在視窗的位置
                let CTM = svg.getScreenCTM();
                newSVGPoint.x = startClient.x;
                newSVGPoint.y = startClient.y;
                let startSVGPoint = newSVGPoint.matrixTransform(CTM.inverse());

                //  4. 計算拖曳後滑鼠所在的 viewport client 座標值
                let moveToClient = {
                    x: e.clientX + e.movementX,
                    y: e.clientY + e.movementY,
                };

                //  5. 計算對應回去的 SVG 座標值
                newSVGPoint = svg.createSVGPoint();
                CTM = svg.getScreenCTM();
                newSVGPoint.x = moveToClient.x;
                newSVGPoint.y = moveToClient.y;
                let moveToSVGPoint = newSVGPoint.matrixTransform(CTM.inverse());

                //  6. 計算位移量
                let delta = {
                    dx: startSVGPoint.x - moveToSVGPoint.x,
                    dy: startSVGPoint.y - moveToSVGPoint.y,
                };

                //  7. 設定新的 viewBox 值
                let moveToViewBox = `${startViewBox[0] + delta.dx} ${startViewBox[1] + delta.dy
                    } ${startViewBox[2]} ${startViewBox[3]}`;
                svg.setAttribute("viewBox", moveToViewBox);
            }
        }
        //  滑鼠點擊結束（拖曳結束）
        function mouseUp() {
            moving = false;
        } //  結束：滑鼠拖拉的效果

        svg.addEventListener("mousedown", mouseDown, false);
        svg.addEventListener("mousemove", drag, false);
        svg.addEventListener("mouseup", mouseUp, false);
        //----------------------------------縮放
        function zoom(e) {
            //  1.取得一開始的 viewBox。
            let startViewBox = svg
                .getAttribute("viewBox")
                .split(" ")
                .map((n) => parseFloat(n));

            //  2.取得滑鼠執行縮放位置的 viewPort Client 座標，並利用 CTM 對應取得 SVG 座標。

            //  2.1 取得滑鼠執行縮放的位置
            let startClient = {
                x: e.clientX,
                y: e.clientY,
            };

            //  2.2 轉換成 SVG 座標系統中的 SVG 座標點
            let newSVGPoint = svg.createSVGPoint();
            let CTM = svg.getScreenCTM();
            newSVGPoint.x = startClient.x;
            newSVGPoint.y = startClient.y;
            let startSVGPoint = newSVGPoint.matrixTransform(CTM.inverse());

            //  3.進行縮放，如果要讓原本的尺寸縮放兩倍的話。
            //  3.1 設定縮放倍率
            let r;
            //e.deltaY是滑鼠滾輪事件的属性，正數代表滾輪向下滾動
            if (e.deltaY > 0) {
                r = 0.9;
            } else if (e.deltaY < 0) {
                r = 1.1;
            } else {
                r = 1;
            }
            //  3.2 進行縮放
            svg.setAttribute(
                "viewBox",
                `${startViewBox[0]} ${startViewBox[1]} ${startViewBox[2] * r} ${startViewBox[3] * r
                }`
            );

            //  4.將一開始滑鼠的執行縮放位置的 viewPort Client 座標利用新的 CTM ，轉換出對應的 SVG 座標。
            CTM = svg.getScreenCTM();
            let moveToSVGPoint = newSVGPoint.matrixTransform(CTM.inverse());

            //  5.取得在縮放過程中該圓點的位移量 `(svgX0 - svgX1)`。
            let delta = {
                dx: startSVGPoint.x - moveToSVGPoint.x,
                dy: startSVGPoint.y - moveToSVGPoint.y,
            };

            //  6.設定最終的 viewBox2
            let middleViewBox = svg
                .getAttribute("viewBox")
                .split(" ")
                .map((n) => parseFloat(n));
            let moveBackViewBox = `${middleViewBox[0] + delta.dx} ${middleViewBox[1] + delta.dy
                } ${middleViewBox[2]} ${middleViewBox[3]}`;
            svg.setAttribute("viewBox", moveBackViewBox);

            //  更新 viewBox 資訊

        } //  結束：滑鼠縮放的效果


        svg.addEventListener("wheel", zoom, false);
        // #endregion

        // #region purchaseConfirm顯示結帳確認座位資訊的相關資訊
        //
        function showNum(element) {
            purchaseNum.textContent = selectList1.value.match(/\d+/)[0];
            var thisSeat = $(element).data("seat-area");
            var thisSeatNum = $(element).data("seat-num")
            var thisPrice = $(element).data("seat-price")
            seatNum.textContent = `${thisSeat} ,Sec ${thisSeatNum}`
            seatNum2.textContent = `${thisSeat} ,Sec ${thisSeatNum}`
            priceSpan.textContent = `$ ${thisPrice * purchaseNum.textContent}`
            subPrice.textContent = `$ ${thisPrice * purchaseNum.textContent}`
            perPrice = thisPrice
        }
        //#endregion

        // #region 票卷數量button
        minusBtn.addEventListener("click", () => {
            if (currentNum <= 1) {
                return;
            } else {
                currentNum--;
                purchaseNum.textContent = currentNum;
                purchaseNum2.textContent = currentNum;
                priceSpan.textContent = `$ ${perPrice * purchaseNum.textContent}`
                subPrice.textContent = `$ ${perPrice * purchaseNum.textContent}`
            }
        })
        plusBtn.addEventListener("click", () => {
            currentNum++;
            purchaseNum.textContent = currentNum;
            purchaseNum2.textContent = currentNum;
            priceSpan.textContent = `$ ${perPrice * purchaseNum.textContent}`
            subPrice.textContent = `$ ${perPrice * purchaseNum.textContent}`
        })

        // #endregion

        // #region 價格範圍篩選
        rangeInput.forEach((input) => {
            input.addEventListener("input", (e) => {
                let minRange = parseInt(rangeInput[0].value);
                let maxRange = parseInt(rangeInput[1].value);
                if (maxRange - minRange < rangeMin) {
                    if (e.target.className === "min") {
                        rangeInput[0].value = maxRange - rangeMin;
                    } else {
                        rangeInput[1].value = minRange + rangeMin;
                    }
                } else {
                    rangePrice[0].value = minRange;
                    rangePrice[1].value = maxRange;
                    range.style.left = (minRange / rangeInput[0].max) * 100 + "%";
                    range.style.right = 100 - (maxRange / rangeInput[1].max) * 100 + "%";
                }
            });
        });

        rangePrice.forEach((input) => {
            input.addEventListener("input", (e) => {
                let minPrice = rangePrice[0].value;
                let maxPrice = rangePrice[1].value;
                if (maxPrice - minPrice >= rangeMin && maxPrice <= rangeInput[1].max) {
                    if (e.target.className === "min") {
                        rangeInput[0].value = minPrice;
                        range.style.left = (minPrice / rangeInput[0].max) * 100 + "%";
                    } else {
                        rangeInput[1].value = maxPrice;
                        range.style.right = 100 - (maxPrice / rangeInput[1].max) * 100 + "%";
                    }
                }
            });
        });

        // #endregion

        // #region 點擊渲染顯示區塊座位
        //找到SVG圖的所有座標屬性
        const allPaths = [...document.querySelectorAll("path")]; //演唱會及球場
        const allEllipse = [...document.querySelectorAll("ellipse")] //Movie場館
        const coordinate = [];//場館座標
        var svgContainer = document.querySelector(".pic");
        //記得是用id拿Layer_1做識別
        const theaterDom = svgContainer.querySelector("#Layer_1")
        const theaterElements = svgContainer.querySelectorAll("[class*='Theater']")
        const isMovieTheater = theaterElements.length > 0;
        theaterDom.addEventListener("click", function (event) {
            var target = event.target;
            var targetCoordinate = null;

            if (!isMovieTheater) {
                allPaths.forEach((path) => {
                    //拿到場館所有座標
                    const dAttribute = path.getAttribute("d");
                    coordinate.push(dAttribute);
                });
                //對應target的座標跟coordinate比對
                targetCoordinate = target.getAttribute('d')
                const matching = allPaths.filter(function (path) {
                    return path.getAttribute('d') === targetCoordinate;
                });
                // 切換顏色
                matching.forEach(element => {
                    if (element.getAttribute("style") == "fill:red") {
                        element.style.fill = "";
                    } else {
                        element.setAttribute("style", "fill:red");
                    }
                })
            } else {
                //Movie只要ellipse
                allEllipse.forEach((ellipse) => {
                    const transform = ellipse.getAttribute("transform");
                    coordinate.push(transform);
                });
                // 切換顏色
                theaterElements.forEach((element) => {
                    if (element === target) {
                        if (element.style.fill === "red") {
                            element.style.fill = "";
                        } else {
                            element.style.fill = "red";
                        }
                    }
                });
            }
            //變數承接去比對有沒有在座位渲染區出現

            //下面是渲染座位資料
            var blockClass = target.getAttribute("class");
            var matchingSection = sectionLA.SeatSectionsViewModel.filter(function (section) {
                return section.SectionName === blockClass;
            });

            if (matchingSection) {
                var filterSeats = [];

                matchingSection.forEach(function (item) {
                    var matchingSectionId = item.ID;
                    var isSectionExists = $(`[data-seat-id="${matchingSectionId}"]`).length > 0;
                    if (isSectionExists) {
                        clearSeatById(matchingSectionId);
                    } else {
                        var filterSeat = seatLA.SeatNumsViewModel.filter(function (seat) {
                            return seat.SeatSectionID === matchingSectionId;
                        });

                        filterSeats = filterSeats.concat(filterSeat);
                    }
                });
            }
            displayFilteredSeats(filterSeats, matchingSection);

        });
        function displayFilteredSeats(seatJson, sectionJson) {
            //清空座位

            //渲染新的座位列表
            seatJson.forEach(function (seat) {
                const sectionId = seat.SeatSectionID;
                const matchingSection = sectionJson.find(section => section.ID === sectionId);
                if (matchingSection) {
                    var seatNum = seat.SeatNum;
                    var sectionName = matchingSection.SectionName;
                    var sectionPrice = matchingSection.SectionPrice;

                    if (seat.IsOrdered !== true) {
                        var seatHtml = `<a href="#"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                class="price-delist text-decoration-none"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                data-bs-toggle="offcanvas"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                data-bs-target="#offcanvasScrolling"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                aria-controls="offcanvasScrolling" onclick="showNum(this)" data-seat-id="${sectionId}"  data-seat-area="${sectionName}" data-seat-price="${sectionPrice}"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                data-seat-num="${seatNum}">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <div class="bcg-hover d-flex justify-content-between align-items-center m-2">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <div class="seat-num d-flex flex-column">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <span class="seatNum">Sec ${sectionName} , Num ${seatNum} </span><span class="seat-type">Standard permission</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <div class="seat-price ms-3">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <p class="seatPrice text-decoration-none m-auto">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                $ ${sectionPrice}</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </a>`;

                        $(".list-unstyled").append(seatHtml);
                    }
                }
            });
        };
        function clearSeatById(seatId) {
            $(`[data-seat-id="${seatId}"]`).remove();
        }
        // #endregion

        // #region FilterButton監聽事件，篩選完渲染結果
        $(".applybtn").click(function () {
            selectList2.addEventListener("change", () => {
                selectList1.value = selectList2.value;
            })

            //SelectAllcheckbox

            selAllBtn.addEventListener("click", () => {
                checkBox1.checked = true
                checkBox2.checked = true
                checkBox3.checked = true
                checkBox4.checked = true

            })
            cleAllBtn.addEventListener("click", () => {
                checkBox1.checked = false
                checkBox2.checked = false
                checkBox3.checked = false
                checkBox4.checked = false

            })
            var minPrice = parseFloat($("input[name='min']").val());
            var maxPrice = parseFloat($("input[name='max']").val());
            var matchingSection = sectionLA.SeatSectionsViewModel.filter(function (section) {
                return section.SectionPrice >= minPrice && section.SectionPrice <= maxPrice;
            });

            if (matchingSection && matchingSection.length > 0) {
                var filterSeats = [];
                var matchingSections = matchingSection.slice(0, 10);
                matchingSections.forEach(function (item) {
                    var filterSeat = seatLA.SeatNumsViewModel.filter(function (seat) {
                        return seat.SeatSectionID === item.ID
                    });

                    filterSeats = filterSeats.concat(filterSeat);
                })
                $(".bcg-hover").remove();

                displayFilteredSeats(filterSeats, matchingSection);
            }
        });
        //#endregion

        // #region cookies
        //清空cookies
        function clearAllCookies() {

            var cookies = document.cookie.split(";");


            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                var eqPos = cookie.indexOf("=");
                var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
                document.cookie = name + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/";
            }
        }
        // #endregion

        // #region 已訂座位渲染
        const { createApp } = Vue;
        createApp({
            methods: {
                axiosData() {
                    axios.get(apiUrl)
                        .then((res) => res.data.SeatSectionsViewModel.forEach(function (section) {
                            const theaterSeat = document.getElementsByClassName(section.SectionName);
                            const filter = seatLA.SeatNumsViewModel.filter(function (seat) {
                                return seat.SeatSectionID === section.ID
                            })
                            if (filter.length > 0) {
                                for (let i = 0; i < theaterSeat.length; i++) {
                                    theaterSeat[i].setAttribute("style", "fill:darkgray;pointer-events:none")

                                }
                            }
                        }))
                        .catch((err) => console.log(err))
                }
            },
            mounted: function () {
                this.axiosData();
            }
        }).mount('#app')
        //#endregion

        // #region 結帳Button (送cookie、改座位狀態)
        $(".next-btn").click(function () {
            var ticketCount = purchaseNum2.textContent;
            var ticketName = seatNum.textContent;
            var eventArray =
                { UserId: 1, EventId: @Model.EventsViewModel.ID, EventName: "@Html.Raw(Model.EventsViewModel.EventName)", EventDate: "@Model.EventsViewModel.EventDate.ToString("yyyy/M/d HH:mm:ss")", TicketCount: ticketCount, TicketPrice: perPrice, TicketName: ticketName };
            var serializedArray = JSON.stringify(eventArray);
            document.cookie = "OrderData=" + encodeURIComponent(serializedArray) + "; max-age=600; path=/;";
            console.log(ticketName)
            //利用SeatNum的資訊去過濾，然後axios打webApi，去資料庫找要的欄位。
            //button click 送出座位號碼，WebApi打進去收到參數，比對資料庫，找到保留時間，開始計算
            var dataToSend = {
                TicketName: decodeURIComponent(ticketName),
                EventId: decodeURIComponent(@Model.EventsViewModel.ID)
            };

            //送座位資訊後端改訂位狀態 IsOrdered = true
            $.ajax({
                url: 'api/PurchaseApi/ChangeSeatStatus',
                type: 'POST',
                data: JSON.stringify(dataToSend),
                contentType: 'application/json;charset=UTF-8',
                dataType: "json",
                success: function (response) {
                    console.log(response.data);
                },
                error: function (error) {
                    console.error(error);
                }
            });
        })
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        //#endregion
    </script>
</body>
</html>


